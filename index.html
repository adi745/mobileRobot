<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MobileRobotApp</title>
    <script src="https://cdn.socket.io/4.7.3/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      const socket = io();
    </script>
    <h1>ArduinoJS course final project</h1>
  </head>
  <link rel="stylesheet" href="style.css" />
  <body>
    <button class="button" id="left-front-on">LEFT FRONT ON</button>
    <button class="button" id="left-front-stop">LEFT FRONT STOP</button>
    <button class="button" id="right-front-on">RIGHT FRONT ON</button>
    <button class="button" id="right-front-stop">RIGHT FRONT STOP</button>
    <div class="space"></div>
    <button class="button" id="left-back-on">LEFT BACK ON</button>
    <button class="button" id="left-back-stop">LEFT BACK STOP</button>
    <button class="button" id="right-back-on">RIGHT BACK ON</button>
    <button class="button" id="right-back-stop">RIGHT BACK STOP</button>
    <div class="space"></div>
    <div class="slide-container">
      <input id="slider" type="range" min="30" max="150" value="90" />
      <p>Servo demand angle: <span id="servo-angle"></span></p>
    </div>
    <div class="space"></div>
    <h2>Servo actual angle:</h2>
    <h2 id="servo-position"></h2>
  </body>
  <script>
    const leftFrontOn = document.getElementById("left-front-on");
    const leftFrontStop = document.getElementById("left-front-stop");
    const rightFrontOn = document.getElementById("right-front-on");
    const rightFrontStop = document.getElementById("right-front-stop");
    const leftBackOn = document.getElementById("left-back-on");
    const leftBackStop = document.getElementById("left-back-stop");
    const rightBackOn = document.getElementById("right-back-on");
    const rightBackStop = document.getElementById("right-back-stop");
    const moveServo = document.getElementById("move-servo");
    const slider = document.getElementById("slider");
    const output = document.getElementById("servo-angle");
    const servoPosition = document.getElementById("servo-position");

    leftFrontOn.addEventListener("click", () => {
      socket.emit("leftFrontOn");
    });

    leftFrontStop.addEventListener("click", () => {
      socket.emit("leftFrontStop");
    });

    rightFrontOn.addEventListener("click", () => {
      socket.emit("rightFrontOn");
    });

    rightFrontStop.addEventListener("click", () => {
      socket.emit("rightFrontStop");
    });

    leftBackOn.addEventListener("click", () => {
      socket.emit("leftBackOn");
    });

    leftBackStop.addEventListener("click", () => {
      socket.emit("leftBackStop");
    });

    rightBackOn.addEventListener("click", () => {
      socket.emit("rightBackOn");
    });

    rightBackStop.addEventListener("click", () => {
      socket.emit("rightBackStop");
    });

    slider.addEventListener("input", function () {
      const demand = this.value;
      output.innerHTML = demand;
      // console.log("Sending slider value:", demand);
      socket.emit("sliderValueChanged", demand); // Send value to server
    });

    //getting info back to the screen
    socket.on("servo-position-value", (data) => {
      servoPosition.innerText = data;
    });

    window.addEventListener("mousemove", (event) => {
      let moveY = event.clientY;
      let moveX = event.clientX;
      socket.emit("moveY", moveY);
      // socket.emit("moveX", moveX);
    });
    //  // Update the current slider value (each time you drag the slider handle)
    //  slider.oninput = function () {
    //       output.innerHTML = this.value;
    //     };
    // output.innerHTML = slider.value; // Display the default slider value
    // const sliderValue = output.innerHTML;

    // slider.addEventListener("input", () => {
    //   let demand = output.value;
    //   socket.emit("demand", demand);
    // });
  </script>
</html>
